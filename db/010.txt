To restore db in sql management studio: right click on 'Databases' folder

RESTORE DATABASE iTosProd WITH RECOVERY

---
USE master
GO

ALTER DATABASE iTosProd
SET SINGLE_USER
--This rolls back all uncommitted transactions in the db.
WITH ROLLBACK IMMEDIATE
GO

RESTORE DATABASE iTosProd
FROM DISK = N'C:\Program Files\Microsoft SQL Server\MSSQL11.MAIN\MSSQL\Backup\iTosProd2.bak'
WITH REPLACE

GO

---
create table #PRODS_TO_KEEP (ID int)
insert into #PRODS_TO_KEEP select PRODUCT_ID from VMG_KIT k join PRODUCT p on k.CODE = p.CODE
insert into #PRODS_TO_KEEP select PRODUCT_ID from VMG_KIT_ITEM
create table #PRODS_TO_REMOVE(ID int)
INSERT INTO #PRODS_TO_REMOVE select PRODUCT_ID FROM STOCK s join STOCK_INFO si on s.STOCK_INFO_ID = si.STOCK_INFO_ID join STOCK_INFO_CONFIG sic on si.STOCK_INFO_CONFIG_ID = sic.STOCK_INFO_CONFIG_ID group by PRODUCT_ID
	HAVING COUNT(*) > 50
delete from #PRODS_TO_REMOVE where ID in (select ID from #PRODS_TO_KEEP)
delete from #PRODS_TO_REMOVE where ID in (select PRODUCT_ID from PRODUCT_INT_COMPANY pic join COMPANY c on pic.INT_COMPANYNR = c.COMPANYNR where c.CODE = 'IC_SGN')

delete s FROM STOCK s join STOCK_INFO si on s.STOCK_INFO_ID = si.STOCK_INFO_ID
	join STOCK_INFO_CONFIG sic on si.STOCK_INFO_CONFIG_ID = sic.STOCK_INFO_CONFIG_ID
	where sic.PRODUCT_ID in (select ID from #PRODS_TO_REMOVE)
---
if not exists
(
	select * from  DW_REPORT_REP_CONTEXT rc, DW_REPORT r, DW_REPORT_CONTEXT c
	where r.REPORT_ID = rc.REPORT_ID and c.REPORT_CONTEXT_ID = rc.REPORT_CONTEXT_ID
		and r.REPORT_KEY = 'PalletLabel' and c.CONTEXT = 'StockChangeOrderItem'
)
insert into DW_REPORT_REP_CONTEXT 
	select REPORT_ID, c.REPORT_CONTEXT_ID
	from DW_REPORT r, DW_REPORT_CONTEXT c
	where r.REPORT_KEY = 'PalletLabel' and c.CONTEXT = 'StockChangeOrderItem'
---
select opr.OPERATION_REPORT_ID, opr.ORDER_ITEM_ID, sic.STOCK_INFO_CONFIG_ID, sic.PRODUCT_ID, p.SHORT_DESC, p.CODE, sis.SID_ID, sis.VALUE, sis.STOCK_INFO_SID_ID  from LOADING_OPERATION_REPORT lor
	join OPERATION_REPORT opr on lor.LOADING_OPERATION_REPORT_ID = opr.OPERATION_REPORT_ID
	join STOCK_INFO si on lor.REPORTED_ID = si.STOCK_INFO_ID
	join STOCK_INFO_CONFIG sic on si.STOCK_INFO_CONFIG_ID = sic.STOCK_INFO_CONFIG_ID
	join STOCK_INFO_SID sis on sic.STOCK_INFO_CONFIG_ID = sis.STOCK_INFO_CONFIG_ID
	join STORAGE_IDENTIFIER sid on sis.SID_ID = sid.STORAGE_IDENTIFIER_ID
	join PRODUCT p on sic.PRODUCT_ID = p.PRODUCT_ID
	where ORDER_ITEM_ID = 5812 and sid.CODE = 'SEQ'
	order by p.SHORT_DESC


select min(o.NUMBER) as 'ORDER', opr.ORDER_ITEM_ID,sic.PRODUCT_ID, min(p.SHORT_DESC) as PRODUCT, min(opr.OPERATION_REPORT_ID) as FIRST_OP_REP_ID,
	COUNT(DISTINCT VALUE) as 'DISTINCT SEQUENCES' from LOADING_OPERATION_REPORT lor
		join OPERATION_REPORT opr on lor.LOADING_OPERATION_REPORT_ID = opr.OPERATION_REPORT_ID
		join STOCK_INFO si on lor.REPORTED_ID = si.STOCK_INFO_ID
		join STOCK_INFO_CONFIG sic on si.STOCK_INFO_CONFIG_ID = sic.STOCK_INFO_CONFIG_ID
		join STOCK_INFO_SID sis on sic.STOCK_INFO_CONFIG_ID = sis.STOCK_INFO_CONFIG_ID
		join STORAGE_IDENTIFIER sid on sis.SID_ID = sid.STORAGE_IDENTIFIER_ID
		join ORDER_ITEM oi on opr.ORDER_ITEM_ID = oi.ORDER_ITEM_ID
		join ORDERS o on oi.ORDER_ID = o.ORDER_ID
		join PRODUCT p on sic.PRODUCT_ID = p.PRODUCT_ID
		where opr.ORDER_ITEM_ID > 5810 and sid.CODE = 'SEQ'
		group by opr.ORDER_ITEM_ID, sic.PRODUCT_ID
		HAVING COUNT(DISTINCT VALUE) > 1

UPDATE STOCK_INFO_SID set VALUE = '000020' where STOCK_INFO_SID_ID IN (4110355, 4110369) -- OI 5844
UPDATE ORDER_ITEM SET STATUS = 2 WHERE ORDER_ITEM_ID = 5844

UPDATE STOCK_INFO_SID set VALUE = '000170' where STOCK_INFO_SID_ID IN (4135535, 4135549, 4135563, 4135577, 4135591, 4135605, 4135619) -- OI 5812
UPDATE STOCK_INFO_SID set VALUE = '000180' where STOCK_INFO_SID_ID IN (4135199, 4135213, 4135227, 4135297, 4135311, 4135325, 4135339, 4135353, 4135367, 4135381, 4135395, 4135409, 4135423, 4135437, 4135451, 4135521)
UPDATE STOCK_INFO_SID set VALUE = '000080' where STOCK_INFO_SID_ID IN (4132753, 4132767)
UPDATE ORDER_ITEM SET STATUS = 2 WHERE ORDER_ITEM_ID = 5812

 not in
select LOADING_OPERATION_REPORT_ID from LOADING_OPERATION_REPORT where TRANSPORT_ID = 4748 and LOADING_OPERATION_REPORT_ID not in
(select OPERATION_REPORT_ID from OPERATION_REPORT where ORDER_ITEM_ID = 5812)